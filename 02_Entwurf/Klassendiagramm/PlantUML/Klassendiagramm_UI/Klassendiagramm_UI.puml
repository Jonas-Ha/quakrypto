@startuml name

skinparam pageMargin 10
skinparam pageExternalColor gray
skinparam pageBorderColor black


class App
{
	- navigator : Navigator
	- MainWindow : MainView
}

package Commands
{
	class DelegateCommand
	{
		+ CanExecuteChanged : event Eventhandler
		+ execute : Action<object>
		+ canExecute : Predicate<object>?
		+ DelegateCommand()
		+ CanExecute() : bool
		+ Execute(): void
		+ RaiseCanExecuteChanged(): void
	}
}

class InsertionAdorner
{
 	- isSeparatorHorizontal : bool
	+ <<get, set>> IsInFirstHalf : bool
	- adornerLayer : AdornerLayer
	- pen : Pen
	- triangle : PathGeometry
	+ InsertionAdorner() : void
	# OnRender() : void
	- DrawTriangle() : void
	- CalculateStartAndEndPoint() : void
	+ Detach() : void
}

class DraggedAdorner
{
	- contentPresenter : ContentPresenter
	- left : double
	- top : double
	- adornerLayer : AdornerLayer
	+ DraggedAdorner() : void
	+ SetPosition() : void
	# MeasureOverride() : Size
	# ArrangeOverride() : Size
	# GetVisualChild() : Visual
	# VisualChildrenCount() : int
	# GetDesiredTransform() : GeneralTransform
	+ Detach() : void
}

class DragDropHelper
{
	- format : DataFormat
	- initialMousePosition : Point
	- initialMouseOffset : Vector
	- draggedData : object
	- draggedAdorner : DraggedAdorner
	- insertionAdorner : InsertionAdorner
	- topWindow : Window
	- sourceItemsControl : ItemsControl
	- sourceItemContainer : FrameworkElement
	- targetItemsControl : ItemsControl
	- targetItemContainer : FrameworkElement
	- hasVerticalOrientation : bool
	- insertionIndex : int
	- isInFirstHalf : bool
	- instance : DragDropHelper
	- <<get, >> Instance : DragDropHelper
	+ GetIsDragSource() : bool
	+ SetIsDragSource() : void
	+ IsDragSourceProperty : DependencyProperty
	+ GetIsDropTarget() : bool
	+ SetIsDropTarget() :void
	+ IsDropTargetProperty :DependencyProperty
	+ GetDragDropTemplate() : DataTemplate
	+ SetDragDropTemplate() :void
	+ DragDropTemplateProperty :DependencyProperty
	- IsDragSourceChanged() :void
	- IsDropTargetChanged() :void
	- DragSource_PreviewMouseLeftButtonDown() :void
	- DragSource_PreviewMouseMove() :void
	- DragSource_PreviewMouseLeftButtonUp() :void
	- DropTarget_PreviewDragEnter() :void
	- DropTarget_PreviewDragOver() :void
	- DropTarget_PreviewDrop() :void
	- DropTarget_PreviewDragLeave() :void
	- DecideDropTarget() :void
	- IsDropDataTypeAllowed() : bool
	- TopWindow_DragEnter() :void
	- TopWindow_DragOver() :void
	- TopWindow_DragLeave() :void
	- ShowDraggedAdorner() :void
	- RemoveDraggedAdorner() :void
	- CreateInsertionAdorner() :void
	- UpdateInsertionAdornerPosition() :void
	- RemoveInsertionAdorner() :void
}

class Utilities
{
	+ HasVerticalOrientation() : bool
	+ InsertItemInItemsControl() : void
	+ RemoveItemFromItemsControl() : int
	+ IsInFirstHalf() : bool
	+ IsMovementBigEnough() : bool
}

/'************************************************************'/
/'PACKAGE UI												  '/
/'************************************************************'/
package UI
{
	together{
		class MainView
		{
		}

		class MainViewModel
		{
			- _navigator : Navigator
			+ << get, >> AktuellesViewModel : BaseViewModel
			+ MainViewModel(Navigator)
			- aktuellesViewModelGeaendert() : void
		}

		class Navigator
		{
			+ aktuellesViewModelGeaendert : event Action
			- _aktuellesviewModel : BaseViewModel
			+ aktuellesViewModel() : BaseViewModel
			+ << get, set >> aktuellesViewModel() : BaseViewModel
			- ViewModelWurdeGe√§ndert() : void
		}

		class BaseViewModel
		{
			+ PropertyChanged : event
			+ BaseViewModel() : void
			+ PropertyChangedEventHandler() : event
			# OnPropertyChanged() : void
			# RaisedPropertyChanged() : void
		}
	}

	together{
		class LobbyErstellenViewModel
		{
			- _lobbyname: string 
			- _ausgProtokoll: int 
			- _ausgSchwierigkeit: int 
			- _ausgVariante: int 
			- _ausgPhaseStart: int 
			- _ausgPhaseEnde: int 
			- _netzwerkbasiert: bool 
			+ <<get, set>> Lobbyname: string 
			+ <<get, set>> AusgProtokoll: int 
			+ <<get, set>> AusgSchwierigkeit: int 
			+ <<get, set>> AusgVariante: int 
			+ <<get, set>> AusgPhaseStart: int 
			+ <<get, set>> AusgPhaseEnde: int 
			+ <<get, set>> Netzwerkbasiert: bool 
			+ LobbyErstellen : DelegateCommand
			+ HauptMenu : DelegateCommand
			+ LobbyErstellenViewModel() : void	
		}

		class LobbyErstellenView
		{
		}
	}
	
	together{
		class LobbyBeitrittViewModel
		{
			+ HauptMenu : DelegateCommand
			+ LobbyBeitreten : DelegateCommand
			- _ausgewaehlteLobby : int



			+ verfuegbareLobbys : ObservableCollection 
			+ ausgewaehlteLobby : int 
			+ LobbyBeitretenViewModel() : void 
			+ SpielBeitreten() : void 
			# SpielBeitretenCommand() : void 
			# ZurueckZumHauptmenueCommand() : void 
		}

		class LobbyBeitrittView
		{
		}
	}
	
	together{
		class HauptMenueViewModel
		{
			+ HauptMenueViewModel() : void
			+ LobbyErstellen : DelegateCommand
			# LobbyBeitreten : DelegateCommand
		}
			
		class HauptMenueView
		{
		}
	}
	
	together{
		class LobbyScreenViewModel
		{
			+ NameLobby : string
			+ Variante : string
			+ Schwierigkeitsgrad : string
			+ Phase : string
			+ Protokoll : string
			+ AliasAliceText : string
			+ AliasBobText : string
			+ AliasEveText : string
			+ PasswortAliceText : string
			+ PasswortBobText : string
			+ PasswortEveText : string
			+ BenutzerRollenCollection : ObservableCollection()
			+ LobbyViewModel() : void
			+ SpielStarten() : void
			# SpielStartenCommand() : void
			# LobbyVerlassenCommand() : void
			# ButtonBestaetigenCommand() : void
			# ButtonHauptmenueCommand() : void
			# ButtonWikiCommand() : void
		}

		class LobbyScreenView
		{
		}
	}
	
	together{
		class WikiViewModel
		{
			+ WikiSeiten : ObservableCollection<WikiSeite>
			+ SelektierteWikiSeite : WikiSeite
			- editierModus : bool
			+ <<get, set>> EditierModus : bool
			+ LabelSichtbar : Visibility
			+ TextBoxSichtbar : Visibility
			+ SeitenErweitern : DelegateCommand
			+ SeitenBearbeiten : DelegateCommand
			+ SeiteEntfernen : DelegateCommand
			+ SeiteSelektiert : DelegateCommand
			+ WikiViewModel() : void

			# UmbenennenCommand() : void
			# WikiVerlassenCommand() : void
			# ZumHauptmenueCommand() : void
		}

		class WikiView
		{
		}
		
		class WikiButton
		{
		}
	}
	

	together{
		class AufzeichnungViewModel
		{
			- uebungsszenario : IUebungsszenario
			+ HauptMenu : DelegateCommand
			+ AufzeichnungViewModel() : void
		}

		class AufzeichnungView
		{
		}
	}

	together{
		class SpielViewModel
		{
			- uebungsszenario : IUebungsszenario
			+ HauptMenu : DelegateCommand
			+ <<get, set>> BituebertragungEingang: ObservableCollection<Information>
			+ <<get, set>> PhotonenuebertragungEingang : ObservableCollection<Information>  
			+ <<get, set>> BituebertragungAusgang : ObservableCollection<Information>
			+ <<get, set>> PhotonenuebertragungAusgang : ObservableCollection<Information>  
			+ <<get, set>> CraftingFeldPhotonen : Information
			+ <<get, set>> CraftingFeldPolarisation : Information
			+ <<get, set>> CraftingFeldErgebnis : Information
			+ <<get, set>> Muelleimer : Information
			+ <<get, set>> Informationsablage : Information 
			+ SpielEveViewModel() : void
			# BitfolgeErzeugenCommand() : void /'Bitzahlen Icon'/
			# Ver_EntschluesselnCommand() : void /'Schluessel Icon'/
			# PhotonenErzeugenCommand() : void /'P Icon'/
			# PolschaErzeugenCommand() : void /'Filter Icon'/
			# StreichenCommand() : void /'Radiergummi Icon'/
			# TextEditierenCommand() : void /'Editieren Icon'/
			# VergleichenCommand() : void /'Waage Icon'/
			# ZahlErzeugenCommand() : void /'Raute Icon'/
			# ZufaelligGenerierenCommand() : void /'Wuerfel Icon'/
			# FragezeichenCommand() : void /'Fragezeichen Icon'/
			# ZugBeendenCommand() : void
			# HauptmenueCommand() : void
			# OperationAusfuhrenCommand() : void
			# InformationLoeschenCommand() : void
		}
		
		class SpielView
		{
		}

		note right of SpielViewModel
		Bitzahlen Icon : BitfolgeErzeugenCommand()
		Schluessel Icon : Ver_EntschluesselnCommand()
		P Icon : PhotonenErzeugenCommand()
		Filter Icon : PolschaErzeugenCommand()
		Radiergummi Icon : StreichenCommand()
		Editieren Icon : TextEditierenCommand()
		Waage Icon : VergleichenCommand()
		Raute Icon : ZahlErzeugenCommand()
		Wuerfel Icon : ZufaelligGenerierenCommand()
		Fragezeichen Icon : FragezeichenCommand()
		end note
	}

	together{
		class SpielEveViewModel
		{
			- uebungsszenario : IUebungsszenario
			+ HauptMenu : DelegateCommand
			+ <<get, set>> BituebertragungEingangAlice : ObservableCollection<Information> 
			+ <<get, set>> BituebertragungEingangBob : ObservableCollection<Information>
			+ <<get, set>> PhotonenuebertragungEingangAlice : ObservableCollection<Information>
			+ <<get, set>> PhotonenuebertragungEingangBob : ObservableCollection<Information>  
			+ <<get, set>> BituebertragungAusgangAlice : ObservableCollection<Information>
			+ <<get, set>> BituebertragungAusgangBob : ObservableCollection<Information>
			+ <<get, set>> PhotonenuebertragungAusgangAlice : ObservableCollection<Information>
			+ <<get, set>> PhotonenuebertragungAusgangBob : ObservableCollection<Information>  
			+ <<get, set>> CraftingFeldPhotonen : Information
			+ <<get, set>> CraftingFeldPolarisation : Information
			+ <<get, set>> CraftingFeldErgebnis : Information
			+ <<get, set>> Muelleimer : Information
			+ <<get, set>> Informationsablage : Information 
			+ SpielEveViewModel() : void
			# BitfolgeErzeugenCommand() : void /'Bitzahlen Icon'/
			# Ver_EntschluesselnCommand() : void /'Schluessel Icon'/
			# PhotonenErzeugenCommand() : void /'P Icon'/
			# PolschaErzeugenCommand() : void /'Filter Icon'/
			# StreichenCommand() : void /'Radiergummi Icon'/
			# TextEditierenCommand() : void /'Editieren Icon'/
			# VergleichenCommand() : void /'Waage Icon'/
			# ZahlErzeugenCommand() : void /'Raute Icon'/
			# ZufaelligGenerierenCommand() : void /'Wuerfel Icon'/
			# FragezeichenCommand() : void /'Fragezeichen Icon'/
			# ZugBeendenCommand() : void
			# HauptmenueCommand() : void
			# OperationAusfuhrenCommand() : void
			# InformationLoeschenCommand() : void
		}

		class SpielEveView
		{
		}

		note left of SpielEveViewModel
		Bitzahlen Icon : BitfolgeErzeugenCommand() : void
		Schluessel Icon : Ver_EntschluesselnCommand() : void
		P Icon : PhotonenErzeugenCommand() : void
		Filter Icon : PolschaErzeugenCommand() : void
		Radiergummi Icon : StreichenCommand() : void
		Editieren Icon : TextEditierenCommand() : void
		Waage Icon : VergleichenCommand() : void
		Raute Icon : ZahlErzeugenCommand() : void
		Wuerfel Icon : ZufaelligGenerierenCommand() : void
		Fragezeichen Icon : FragezeichenCommand() : void
		end note
	}
	
	together{
		class RolleEntsperrenViewModel
		{
			- passwort : string
			# RolleEntsperrenCommand() : void 
			# ZumHauptmenueCommand() : void
		}

		class RolleEntsperrenView
		{
		}
	}

	
}
App -- MainView
App -- Navigator
MainView -- MainViewModel
BaseViewModel <|-u- RolleEntsperrenViewModel
BaseViewModel <|-u- AufzeichnungViewModel
BaseViewModel <|-u- SpielEveViewModel
BaseViewModel <|-u- SpielViewModel
BaseViewModel <|-u- LobbyBeitrittViewModel
BaseViewModel <|-u- LobbyScreenViewModel
BaseViewModel <|-- WikiViewModel
BaseViewModel <|-- HauptMenueViewModel
BaseViewModel <|-- LobbyErstellenViewModel
BaseViewModel <|-- MainViewModel
Navigator -- MainViewModel
SpielView -- SpielViewModel
SpielEveView -- SpielEveViewModel
RolleEntsperrenView -- RolleEntsperrenViewModel
LobbyErstellenView -- LobbyErstellenViewModel
LobbyBeitrittView -- LobbyBeitrittViewModel
AufzeichnungView -- AufzeichnungViewModel
HauptMenueView -- HauptMenueViewModel
LobbyScreenView -- LobbyScreenViewModel
WikiView -- WikiViewModel

@enduml